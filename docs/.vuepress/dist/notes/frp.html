<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Frps服务端/Frp客户端 | 全栈攻城狮</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/assets/img/logo.gif">
    <script type="text/javascript" src="/assets/js/push.js"></script>
    <meta name="description" content="欢迎来到全栈攻城狮的分享集">
    <meta property="article:modified_time" content="2021-07-01T04:35:49.000Z">
    <meta property="og:site_name" content="全栈攻城狮">
    <meta property="og:title" content="Frps服务端/Frp客户端">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/notes/frp.html">
    <meta name="twitter:title" content="Frps服务端/Frp客户端">
    <meta name="twitter:url" content="/notes/frp.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="referrer" content="never">
    <meta name="keywords" content="全栈笔记,vuepress,git,electron,vue,uniapp,coding,全栈工程师,小宋,antdocs,antdeisgn,vuepress,vuepress-theme,theme,ant,docs,antd,antdocs of vuepress,主题,vuepress主题,antd设计,blog,vuepress-blog">
    <link rel="preload" href="/assets/css/0.styles.778863b0.css" as="style"><link rel="preload" href="/assets/js/app.3af86040.js" as="script"><link rel="preload" href="/assets/js/2.e0e877e7.js" as="script"><link rel="preload" href="/assets/js/32.8e2d0397.js" as="script"><link rel="prefetch" href="/assets/js/10.fb64d3b7.js"><link rel="prefetch" href="/assets/js/11.91c9a85f.js"><link rel="prefetch" href="/assets/js/12.6f6c280b.js"><link rel="prefetch" href="/assets/js/13.555111b0.js"><link rel="prefetch" href="/assets/js/14.f0c7a9f0.js"><link rel="prefetch" href="/assets/js/15.41f0372e.js"><link rel="prefetch" href="/assets/js/16.10d2c088.js"><link rel="prefetch" href="/assets/js/17.1f502160.js"><link rel="prefetch" href="/assets/js/18.d0fb8c6d.js"><link rel="prefetch" href="/assets/js/19.8bcf4e29.js"><link rel="prefetch" href="/assets/js/20.c469d5a1.js"><link rel="prefetch" href="/assets/js/21.7e69d04e.js"><link rel="prefetch" href="/assets/js/22.0921ea8b.js"><link rel="prefetch" href="/assets/js/23.e5c570ba.js"><link rel="prefetch" href="/assets/js/24.ab1a2b7d.js"><link rel="prefetch" href="/assets/js/25.a6aec41e.js"><link rel="prefetch" href="/assets/js/26.8d711a18.js"><link rel="prefetch" href="/assets/js/27.f5b1e13d.js"><link rel="prefetch" href="/assets/js/28.6bea2254.js"><link rel="prefetch" href="/assets/js/29.6a7bda7d.js"><link rel="prefetch" href="/assets/js/3.aa3564cb.js"><link rel="prefetch" href="/assets/js/30.0ca7ad1b.js"><link rel="prefetch" href="/assets/js/31.9c7e1d52.js"><link rel="prefetch" href="/assets/js/33.b7554844.js"><link rel="prefetch" href="/assets/js/34.7a472dbe.js"><link rel="prefetch" href="/assets/js/35.822800fa.js"><link rel="prefetch" href="/assets/js/36.b3019114.js"><link rel="prefetch" href="/assets/js/37.7640a962.js"><link rel="prefetch" href="/assets/js/38.a7fe73df.js"><link rel="prefetch" href="/assets/js/39.991373c6.js"><link rel="prefetch" href="/assets/js/4.ebcdd46a.js"><link rel="prefetch" href="/assets/js/40.96c18810.js"><link rel="prefetch" href="/assets/js/41.fa1fbef3.js"><link rel="prefetch" href="/assets/js/42.3e73e4f7.js"><link rel="prefetch" href="/assets/js/43.96c9f257.js"><link rel="prefetch" href="/assets/js/44.ce913dde.js"><link rel="prefetch" href="/assets/js/45.3d8ae671.js"><link rel="prefetch" href="/assets/js/46.d7b5d112.js"><link rel="prefetch" href="/assets/js/47.b706eb40.js"><link rel="prefetch" href="/assets/js/48.0a3de442.js"><link rel="prefetch" href="/assets/js/49.18392c11.js"><link rel="prefetch" href="/assets/js/5.5d377af6.js"><link rel="prefetch" href="/assets/js/50.67f1f767.js"><link rel="prefetch" href="/assets/js/51.37f9fa22.js"><link rel="prefetch" href="/assets/js/52.8c5d1155.js"><link rel="prefetch" href="/assets/js/53.6ff26e2d.js"><link rel="prefetch" href="/assets/js/54.892d88c0.js"><link rel="prefetch" href="/assets/js/55.71cd584e.js"><link rel="prefetch" href="/assets/js/6.3f5ebda8.js"><link rel="prefetch" href="/assets/js/7.246e2052.js"><link rel="prefetch" href="/assets/js/8.34dd9047.js"><link rel="prefetch" href="/assets/js/9.8c5944c7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.778863b0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="nav-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/assets/logo.gif" alt="全栈攻城狮" class="logo"> <span class="site-name">全栈攻城狮</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          首页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/notes/git.html">
          日常笔记
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          专题笔记
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          开源项目
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/case/">
          收录
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/metoyun/xiao_song_note" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><div><div class="promo"><div id="promo_3"><div class="promo_title">Sponsor</div> <button type="button" class="ant-btn ant-btn-primary ant-btn-background-ghost"><span>Become a Sponsor</span></button></div></div> <div role="separator" id="reset-margin" class="ant-divider ant-divider-horizontal ant-divider-dashed"></div></div> <ul class="sidebar-links"><li><a href="/notes/git-webhook.html" title="利用webhook实现自动化部署" class="sidebar-link">利用webhook实现自动化部署</a></li><li><a href="/notes/git.html" title="Git" class="sidebar-link">Git</a></li><li><a href="/notes/nginx.html" title="Nginx笔记" class="sidebar-link">Nginx笔记</a></li><li><a href="/notes/node.html" title="Node.js笔记" class="sidebar-link">Node.js笔记</a></li><li><a href="/notes/npm.html" title="Npm笔记" class="sidebar-link">Npm笔记</a></li><li><a href="/notes/typeorm.html" title="TypeORM笔记" class="sidebar-link">TypeORM笔记</a></li><li><a href="/notes/vscode.html" title="Vscode快捷键" class="sidebar-link">Vscode快捷键</a></li><li><a href="/notes/brew.html" title="mac安装brew" class="sidebar-link">mac安装brew</a></li><li><a href="/notes/frp.html" aria-current="page" title="Frps服务端/Frp客户端" class="active sidebar-link">Frps服务端/Frp客户端</a></li><li><a href="/notes/openssl.html" title="openssl" class="sidebar-link">openssl</a></li><li><a href="/notes/ssh.html" title="ssh" class="sidebar-link">ssh</a></li><li><a href="/notes/package.html" title="package" class="sidebar-link">package</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="安装frps服务端"><a href="#安装frps服务端" class="header-anchor">#</a> 安装frps服务端：</h1> <ol><li>新建一个存放目录</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>
 <span class="token function">mkdir</span> frps

</code></pre></div><ol start="2"><li>拉取一键搭建脚本</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">wget</span> --no-check-certificate https://raw.githubusercontent.com/clangcn/onekey-install-shell/master/frps/install-frps.sh -O ./install-frps.sh
</code></pre></div><ol start="3"><li>增加脚本权限</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>
 <span class="token function">chmod</span> <span class="token number">700</span> ./install-frps.sh

</code></pre></div><ol start="4"><li>安装</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code> ./install-frps.sh <span class="token function">install</span>
 
</code></pre></div><blockquote><p>之后他会让你输一些参数，全部参数都有默认值，直接回车就是输入默认值：</p></blockquote> <div class="language-sh extra-class"><pre class="language-sh"><code>Please input frps bind_port <span class="token punctuation">[</span><span class="token number">1</span>-65535<span class="token punctuation">]</span><span class="token punctuation">(</span>Default Server Port: <span class="token number">5443</span><span class="token punctuation">)</span>: <span class="token comment">#输入frp提供服务的端口，用于服务器端和客户端通信，默认即可</span>
Please input frps vhost_http_port <span class="token punctuation">[</span><span class="token number">1</span>-65535<span class="token punctuation">]</span><span class="token punctuation">(</span>Default vhost_http_port: <span class="token number">80</span><span class="token punctuation">)</span>: <span class="token comment">#输入frp进行http穿透的http服务端口，建议选择其他端口，默认的80端口给Nignx，然后用Nginx代理frp的http端口</span>
Please input frps vhost_https_port <span class="token punctuation">[</span><span class="token number">1</span>-65535<span class="token punctuation">]</span><span class="token punctuation">(</span>Default vhost_https_port: <span class="token number">443</span><span class="token punctuation">)</span>: <span class="token comment">#输入frp进行https穿透的https服务端口，同上面的80端口类似，建议分配其他端口，然后通过Nginx代理此端口</span>
Please input frps dashboard_port <span class="token punctuation">[</span><span class="token number">1</span>-65535<span class="token punctuation">]</span><span class="token punctuation">(</span>Default dashboard_port: <span class="token number">6443</span><span class="token punctuation">)</span>:<span class="token comment">#输入frp的控制台服务端口，用于查看frp工作状态，默认即可</span>

Please input dashboard_user <span class="token punctuation">(</span>Default: admin<span class="token punctuation">)</span>:<span class="token comment">#登录控制台的用户名，默认即可</span>
Please input dashboard_pwd <span class="token punctuation">(</span>Default: arepR7VZ<span class="token punctuation">)</span>:<span class="token comment">#登录控制台的密码，如果记不住默认的建议修改</span>


Please input privilege_token <span class="token punctuation">(</span>Default: 9e2UAeWa6hxrwdc<span class="token punctuation">)</span>:<span class="token comment">#输入frp服务器和客户端通信的密码，默认是随机生成的，默认即可</span>
Please input frps max_pool_count <span class="token punctuation">[</span><span class="token number">1</span>-200<span class="token punctuation">]</span><span class="token punctuation">(</span>Default max_pool_count: <span class="token number">50</span><span class="token punctuation">)</span>:<span class="token comment">#设置每个代理可以创建的连接池上限，默认50</span>

</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">##### Please select log_level #####</span>
<span class="token number">1</span>: info
<span class="token number">2</span>: warn
<span class="token number">3</span>: error
<span class="token number">4</span>: debug
<span class="token comment">#####################################################</span>
Enter your choice <span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span>, <span class="token number">4</span> or exit. default <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>: 默认即可
Please input frps log_max_days <span class="token punctuation">[</span><span class="token number">1</span>-30<span class="token punctuation">]</span><span class="token punctuation">(</span>Default log_max_days: <span class="token number">3</span> day<span class="token punctuation">)</span>: 默认即可
<span class="token comment">##### Please select log_file #####</span>
<span class="token number">1</span>: <span class="token builtin class-name">enable</span>
<span class="token number">2</span>: disable
<span class="token comment">#####################################################</span>
Enter your choice <span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span> or exit. default <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>:默认即可

安装完毕后会弹出以下内容，标明了具体信息，到此服务端操作全部完成。
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
You Server IP      <span class="token builtin class-name">:</span> X.X.X.X
Bind port          <span class="token builtin class-name">:</span> <span class="token number">5443</span>
KCP support        <span class="token builtin class-name">:</span> <span class="token boolean">true</span>
vhost http port    <span class="token builtin class-name">:</span> <span class="token number">8085</span>
vhost https port   <span class="token builtin class-name">:</span> <span class="token number">4435</span>
Dashboard port     <span class="token builtin class-name">:</span> <span class="token number">6443</span>
token              <span class="token builtin class-name">:</span> 9e2UAeWa6hxrwdc
tcp_mux            <span class="token builtin class-name">:</span> <span class="token boolean">true</span>
Max Pool count     <span class="token builtin class-name">:</span> <span class="token number">50</span>
Log level          <span class="token builtin class-name">:</span> info
Log max days       <span class="token builtin class-name">:</span> <span class="token number">3</span>
Log <span class="token function">file</span>           <span class="token builtin class-name">:</span> <span class="token builtin class-name">enable</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
frps Dashboard     <span class="token builtin class-name">:</span> http://X.X.X.X:6443/
Dashboard user     <span class="token builtin class-name">:</span> admin
Dashboard password <span class="token builtin class-name">:</span> admin
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>


frps status manage <span class="token builtin class-name">:</span> frps <span class="token punctuation">{</span>start<span class="token operator">|</span>stop<span class="token operator">|</span>restart<span class="token operator">|</span>status<span class="token operator">|</span>config<span class="token operator">|</span>version<span class="token punctuation">}</span>
Example:
  start: frps start <span class="token comment"># 启动frps命令</span>
   stop: frps stop <span class="token comment"># 停止frps命令</span>
restart: frps restart <span class="token comment"># 重启frps命令</span>

<span class="token punctuation">[</span>root@root frps<span class="token punctuation">]</span><span class="token comment">#</span>
 
</code></pre></div><blockquote><p>至此，安装完成，可以访问ip地址+控制台端口查看（如果是阿里云腾讯云的服务器或者服务器已安装宝塔面板的，记得在安全组放行以上的配置的端口，否则无法访问），见下图</p></blockquote> <h1 id="frp安装客户端"><a href="#frp安装客户端" class="header-anchor">#</a> Frp安装客户端：</h1> <blockquote><p>下载客户端软件：
Mac版本
https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_darwin_amd64.tar.gz</p></blockquote> <blockquote><p>Win版本
https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_windows_386.zip</p></blockquote> <blockquote><p>Linux版本
https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_linux_amd64.tar.gz</p></blockquote> <div class="language-sh extra-class"><pre class="language-sh"><code>
下载完成后解压，找到 frpc.ini 文件
修改 frpc.ini 文件，假设 frps 所在的服务器的 IP 为 <span class="token number">127.0</span>.0.1，local_port 为本地机器上 web 服务对应的端口, 绑定自定义域名mock.test.com
以下为我本地的配置，可做参考：
<span class="token punctuation">[</span>common<span class="token punctuation">]</span>
server_addr <span class="token operator">=</span> <span class="token number">127.0</span>.0.1
server_port <span class="token operator">=</span> <span class="token number">5443</span>
token <span class="token operator">=</span> 9e2UAeWa6hxrwdc

</code></pre></div><h2 id="通过tcp的方式可以不使用域名的情况下进行内网穿透-直接访问http-127-0-0-1-8080即可"><a href="#通过tcp的方式可以不使用域名的情况下进行内网穿透-直接访问http-127-0-0-1-8080即可" class="header-anchor">#</a> 通过tcp的方式可以不使用域名的情况下进行内网穿透，直接访问http://127.0.0.1:8080即可</h2> <h2 id="tcp穿透需要设置remote-port-为将服务器的8080端口绑定到你的穿透服务-此处的8080端口也需要在防火墙中放开访问权限"><a href="#tcp穿透需要设置remote-port-为将服务器的8080端口绑定到你的穿透服务-此处的8080端口也需要在防火墙中放开访问权限" class="header-anchor">#</a> tcp穿透需要设置remote_port（为将服务器的8080端口绑定到你的穿透服务，此处的8080端口也需要在防火墙中放开访问权限）</h2> <div class="language-conf extra-class"><pre class="language-text"><code>[mock-tcp]
type = tcp
local_ip = 172.18.50.59
local_port = 8089
remote_port = 8080
# custom_domains = mock.frp.test.com

[mock-http]
type = http
local_ip = 172.18.50.59
local_port = 8089
custom_domains = mock.frp.test.com


[web]
type = http
local_ip = 172.18.50.59
local_port = 8091
custom_domains = api.frp.test.com

</code></pre></div><blockquote><p>修改完成后，保存。然后启动 frpc</p></blockquote> <h2 id="启动客户端"><a href="#启动客户端" class="header-anchor">#</a> 启动客户端：</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># liunx启动客户端命令： </span>
./frpc -c ./frpc.ini    ---- ini文件与执行文件在同一目录
<span class="token comment"># win启动客户端命令： </span>
frpc.exe -c ./frpc.ini

</code></pre></div><blockquote><p>注意：frp.test.com这个二级域名需要提前在域名解析中进行A记录解析，见下图：
通过浏览器访问 http://mock.frp.test.com:8085 即可访问到处于内网机器上的 web 服务。
我们通过服务器控制台就可以看到有客户端已经连接了
到此就完成了frp的客户端搭建和连接，完成了内网穿透服务。</p></blockquote> <h2 id="设置客户端自启动"><a href="#设置客户端自启动" class="header-anchor">#</a> 设置客户端自启动：</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># Linux下添加frp内网穿透工具开机启动</span>

<span class="token comment"># 在/etc/rc.local里面添加/home/frp/frps -c /home/frp/frps.ini (文件的具体路径根据实际情况填写),终端里面输入下面的命令，或者把文件下载回本地修改后重新上传覆盖源文件。</span>

<span class="token function">vim</span> /etc/rc.local
 

<span class="token comment"># Windows系统下添加frp内网穿透工具为开机启动项</span>

<span class="token comment"># 因为Windows系统下从命令行启动frp内网穿透工具后，如果关闭命令行的黑窗口，frp内网穿透服务就停止了，并且任务栏上一直有个命令行窗口也很不方便，所以要开机后启动并且要隐藏frp内网穿透工具的窗口，方法是这样的：</span>
<span class="token comment"># 新建一个文本文件，文件内写入如下内容，frp的文件路径根据自己的实际情况修改，然后重命名这个文本文件为frp.vbs ,注意txt的扩展名也要改为vbs，然后把这个frp.vbs放到Windows的启动目录里面。   </span>
<span class="token comment"># Windows的启动目录位于“C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp”（如果找不到这个目录可以在CMD运行里面输入：     “shell:startup” 或者输入“%programdata%\Microsoft\Windows\Start Menu\Programs\Startup”）</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">ws</span><span class="token operator">=</span>WScript.CreateObject<span class="token punctuation">(</span><span class="token string">&quot;WScript.Shell&quot;</span><span class="token punctuation">)</span>
ws.Run <span class="token string">&quot;d:<span class="token entity" title="\f">\f</span>rpc.exe -c d:<span class="token entity" title="\f">\f</span>rpc_net.ini&quot;</span>,0

</code></pre></div><h2 id="自定义域名访问"><a href="#自定义域名访问" class="header-anchor">#</a> 自定义域名访问：</h2> <blockquote><p>上面我们发现连接内网还是需要 输入 8085端口，而且域名是nginx上配置的三级域名，其实我们可以通过Nginx来反向代理一下，这样就可以自己的顶级域名，并通过80端口来访问了。
1、Nginx新建一个虚拟主机配置，或者直接改默认的主机配置也可以
在Nignx 的listen 后 增加 default_server 配置，用来监听默认情况下所有来自解析到该服务器的域名
然后在 server 段内增加 反向代理配置
在nginx子配置文件目录下新增一个名为：frps.conf文件
<code>vim frps.conf</code></p></blockquote> <h2 id="frps内网穿透服务-测试服务为mock服务"><a href="#frps内网穿透服务-测试服务为mock服务" class="header-anchor">#</a> frps内网穿透服务--测试服务为mock服务</h2> <div class="language-conf extra-class"><pre class="language-text"><code>server{
    listen 80;
    listen 8086;
    listen 443 ssl http2;
    server_name mock.frp.test.com;
    location /{
       proxy_redirect off;
       proxy_set_header Host $host;
       proxy_set_header X-Real-IP $remote_addr;
       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       proxy_read_timeout 300;
       proxy_pass http://127.0.0.1:8085;
       access_log /www/wwwlogs/access8085.log;
       error_log /www/wwwlogs/access_error8085.log;
    }
}
 

; 这样Nginx 将接管域名的绑定工作，监听到80端口的网站后，会将网站转发到 本机的frp 8085 端口

</code></pre></div><h2 id="frp进阶配置-未实际测试-摘抄于原作者"><a href="#frp进阶配置-未实际测试-摘抄于原作者" class="header-anchor">#</a> frp进阶配置（未实际测试，摘抄于原作者）：</h2> <div class="language-ini extra-class"><pre class="language-ini"><code>
<span class="token comment">; 1、转发 DNS 查询请求</span>
<span class="token comment">; DNS 查询请求通常使用 UDP 协议，frp 支持对内网 UDP 服务的穿透，配置方式和 TCP 基本一致。</span>
<span class="token comment">; 修改 frpc.ini 文件</span>
<span class="token selector">  [common]</span>
<span class="token constant">  server_addr</span> <span class="token attr-value"><span class="token punctuation">=</span> 180.28.83.22 #这里是服务器的IP</span>
<span class="token constant">  server_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 5443 #服务器的连接端口</span>
<span class="token constant">  token</span> <span class="token attr-value"><span class="token punctuation">=</span> LnDeMkeiIedDeDw #服务器的连接Token</span>
  
<span class="token selector">  [dns]</span>
<span class="token constant">  type</span> <span class="token attr-value"><span class="token punctuation">=</span> udp</span>
<span class="token constant">  local_ip</span> <span class="token attr-value"><span class="token punctuation">=</span> 8.8.8.8</span>
<span class="token constant">  local_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 53</span>
<span class="token constant">  remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 6000</span>



<span class="token comment">;   2、转发 Unix域套接字</span>
<span class="token comment">; 通过 tcp 端口访问内网的 unix域套接字(例如和 docker daemon 通信)。</span>
<span class="token comment">; frps 的部署步骤同上。</span>
<span class="token comment">; 启动 frpc，启用 unix_domain_socket 插件，配置如下：</span>
<span class="token selector">  [common]</span>
<span class="token constant">  server_addr</span> <span class="token attr-value"><span class="token punctuation">=</span> 180.28.83.22 #这里是服务器的IP</span>
<span class="token constant">  server_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 5443 #服务器的连接端口</span>
<span class="token constant">  token</span> <span class="token attr-value"><span class="token punctuation">=</span> LnDeMkeiIedDeDw #服务器的连接Token</span>
  
<span class="token selector">  [unix_domain_socket]</span>
<span class="token constant">  type</span> <span class="token attr-value"><span class="token punctuation">=</span> tcp</span>
<span class="token constant">  remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 6000</span>
<span class="token constant">  plugin</span> <span class="token attr-value"><span class="token punctuation">=</span> unix_domain_socket</span>
<span class="token constant"> plugin_unix_path</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/run/docker.sock</span>
<span class="token comment">; 通过 curl 命令查看 docker 版本信息</span>
curl http://x.x.x.x:6000/version
 
<span class="token comment">; 3、win系统远程桌面</span>
<span class="token comment">; 通过tcp 来连接位于内网中的电脑，配置如下：</span>
<span class="token selector">  [common]</span>
<span class="token constant">  server_addr</span> <span class="token attr-value"><span class="token punctuation">=</span> 180.28.83.22 #这里是服务器的IP</span>
<span class="token constant">  server_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 5443 #服务器的连接端口</span>
<span class="token constant">  token</span> <span class="token attr-value"><span class="token punctuation">=</span> LnDeMkeiIedDeDw #服务器的连接Token</span>
  
<span class="token selector">  [dns]</span>
<span class="token constant">  type</span> <span class="token attr-value"><span class="token punctuation">=</span> tcp</span>
<span class="token constant">  local_ip</span> <span class="token attr-value"><span class="token punctuation">=</span> 127.0.0.1</span>
<span class="token constant">  local_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 3389</span>
<span class="token constant"> remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 33890</span>
<span class="token comment">; 然后通过 mstsc -v 180.28.83.22:33890 就可以远程桌面到内网。</span>


</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/1/2021, 12:35:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/notes/brew.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        mac安装brew
      </a></span> <span class="next"><a href="/notes/openssl.html">
        openssl
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3af86040.js" defer></script><script src="/assets/js/2.e0e877e7.js" defer></script><script src="/assets/js/32.8e2d0397.js" defer></script>
  </body>
</html>